import { Component, ViewChild, ViewEncapsulation, inject } from '@angular/core';
import { map, take } from 'rxjs';
import { ExplorerService } from '../../services/explorer.service';
import { ViewSwitcherComponent } from '../view-switcher/view-switcher.component';
import { CONFIG } from '../../shared/providers';
import { AsyncPipe } from '@angular/common';
import * as i0 from "@angular/core";
export class MenuBarComponent {
    constructor() {
        this.explorerService = inject(ExplorerService);
        this.config = inject(CONFIG);
        this.featDelete = this.config.features?.delete;
        this.featUpload = this.config.features?.upload;
        this.featDownload = this.config.features?.download;
        this.featRename = this.config.features?.rename;
        this.featCreateDir = this.config.features?.createDir;
        this.canDownload$ = this.explorerService.selection$.pipe(map((n) => n.length === 1 && n[0].isLeaf));
        this.canDelete$ = this.explorerService.selection$.pipe(map((n) => n.length > 0));
        this.canRename$ = this.explorerService.selection$.pipe(map((n) => n.length === 1));
    }
    createDir() {
        const name = prompt('Enter new name');
        if (name) {
            this.explorerService.createDir(name);
        }
    }
    refresh() {
        this.explorerService.refresh();
    }
    rename() {
        this.explorerService.selection$
            .pipe(take(1), map((n) => n[0]))
            .subscribe((node) => {
            const oldName = node.name;
            const newName = prompt('Enter new name', oldName);
            if (newName) {
                this.explorerService.rename(newName);
            }
        });
    }
    remove() {
        if (confirm('Are you sure you want to delete the selected files?')) {
            this.explorerService.remove();
        }
    }
    openUploader() {
        this.uploader.nativeElement.click();
    }
    handleFiles(event) {
        const files = event.target.files;
        if (!files || files.length === 0) {
            return;
        }
        this.explorerService.upload(files);
        this.uploader.nativeElement.value = '';
    }
    download() {
        this.explorerService.download();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.2.2", ngImport: i0, type: MenuBarComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.2.2", type: MenuBarComponent, isStandalone: true, selector: "nxe-menu-bar", viewQueries: [{ propertyName: "uploader", first: true, predicate: ["uploader"], descendants: true, static: true }], ngImport: i0, template: "<div class=\"nxe-menu-bar\">\n    <div class=\"nxe-menu-bar-left\">\n        @if (featCreateDir) {\n            <button class=\"nxe-menu-bar-button\" (click)=\"createDir()\"><i class=\"nxe-folder\" aria-hidden=\"true\"></i>New Folder</button>\n        }\n\n        <button class=\"nxe-menu-bar-button\" (click)=\"refresh()\"><i class=\"nxe-arrows-cw\" aria-hidden=\"true\"></i> Refresh</button>\n\n        @if (featUpload) {\n            <button class=\"nxe-menu-bar-button\" (click)=\"openUploader()\"><i class=\"nxe-upload\" aria-hidden=\"true\"></i> Upload</button>\n        }\n\n        @if (featDownload) {\n            <button class=\"nxe-menu-bar-button\" [disabled]=\"!(canDownload$ | async)\" (click)=\"download()\">\n                <i class=\"nxe-download\" aria-hidden=\"true\"></i> Download\n            </button>\n        }\n\n        @if (featRename) {\n            <button class=\"nxe-menu-bar-button\" [disabled]=\"!(canRename$ | async)\" (click)=\"rename()\">\n                <i class=\"nxe-edit\" aria-hidden=\"true\"></i> Rename\n            </button>\n        }\n\n        @if (featDelete) {\n            <button class=\"nxe-menu-bar-button\" [disabled]=\"!(canDelete$ | async)\" (click)=\"remove()\">\n                <i class=\"nxe-trash-empty\" aria-hidden=\"true\"></i> Delete\n            </button>\n        }\n    </div>\n    <div class=\"nxe-menu-bar-right\">\n        <nxe-view-switcher></nxe-view-switcher>\n    </div>\n    <input style=\"display: none\" type=\"file\" multiple (change)=\"handleFiles($event)\" #uploader />\n</div>\n", styles: [".nxe-menu-bar{display:flex}.nxe-menu-bar .nxe-menu-bar-left{flex-grow:1;padding:10px}.nxe-menu-bar .nxe-menu-bar-button{cursor:pointer;padding:5px;border-radius:5px;background:transparent;border:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin-right:20px}.nxe-menu-bar .nxe-menu-bar-button .nxe-folder{color:#fdb900}.nxe-menu-bar .nxe-menu-bar-button .nxe-arrows-cw{color:green}.nxe-menu-bar .nxe-menu-bar-button .nxe-trash-empty{color:#ca0801}.nxe-menu-bar .nxe-menu-bar-button:hover{background-color:#d7edff}\n"], dependencies: [{ kind: "component", type: ViewSwitcherComponent, selector: "nxe-view-switcher" }, { kind: "pipe", type: AsyncPipe, name: "async" }], encapsulation: i0.ViewEncapsulation.None }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.2.2", ngImport: i0, type: MenuBarComponent, decorators: [{
            type: Component,
            args: [{ selector: 'nxe-menu-bar', encapsulation: ViewEncapsulation.None, standalone: true, imports: [ViewSwitcherComponent, AsyncPipe], template: "<div class=\"nxe-menu-bar\">\n    <div class=\"nxe-menu-bar-left\">\n        @if (featCreateDir) {\n            <button class=\"nxe-menu-bar-button\" (click)=\"createDir()\"><i class=\"nxe-folder\" aria-hidden=\"true\"></i>New Folder</button>\n        }\n\n        <button class=\"nxe-menu-bar-button\" (click)=\"refresh()\"><i class=\"nxe-arrows-cw\" aria-hidden=\"true\"></i> Refresh</button>\n\n        @if (featUpload) {\n            <button class=\"nxe-menu-bar-button\" (click)=\"openUploader()\"><i class=\"nxe-upload\" aria-hidden=\"true\"></i> Upload</button>\n        }\n\n        @if (featDownload) {\n            <button class=\"nxe-menu-bar-button\" [disabled]=\"!(canDownload$ | async)\" (click)=\"download()\">\n                <i class=\"nxe-download\" aria-hidden=\"true\"></i> Download\n            </button>\n        }\n\n        @if (featRename) {\n            <button class=\"nxe-menu-bar-button\" [disabled]=\"!(canRename$ | async)\" (click)=\"rename()\">\n                <i class=\"nxe-edit\" aria-hidden=\"true\"></i> Rename\n            </button>\n        }\n\n        @if (featDelete) {\n            <button class=\"nxe-menu-bar-button\" [disabled]=\"!(canDelete$ | async)\" (click)=\"remove()\">\n                <i class=\"nxe-trash-empty\" aria-hidden=\"true\"></i> Delete\n            </button>\n        }\n    </div>\n    <div class=\"nxe-menu-bar-right\">\n        <nxe-view-switcher></nxe-view-switcher>\n    </div>\n    <input style=\"display: none\" type=\"file\" multiple (change)=\"handleFiles($event)\" #uploader />\n</div>\n", styles: [".nxe-menu-bar{display:flex}.nxe-menu-bar .nxe-menu-bar-left{flex-grow:1;padding:10px}.nxe-menu-bar .nxe-menu-bar-button{cursor:pointer;padding:5px;border-radius:5px;background:transparent;border:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin-right:20px}.nxe-menu-bar .nxe-menu-bar-button .nxe-folder{color:#fdb900}.nxe-menu-bar .nxe-menu-bar-button .nxe-arrows-cw{color:green}.nxe-menu-bar .nxe-menu-bar-button .nxe-trash-empty{color:#ca0801}.nxe-menu-bar .nxe-menu-bar-button:hover{background-color:#d7edff}\n"] }]
        }], propDecorators: { uploader: [{
                type: ViewChild,
                args: ['uploader', { static: true }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS1iYXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LWV4cGxvcmVyL3NyYy9saWIvY29tcG9uZW50cy9tZW51LWJhci9tZW51LWJhci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtZXhwbG9yZXIvc3JjL2xpYi9jb21wb25lbnRzL21lbnUtYmFyL21lbnUtYmFyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQWMsU0FBUyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM1RixPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUVqQyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0saUNBQWlDLENBQUM7QUFDbEUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sMENBQTBDLENBQUM7QUFDakYsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ2hELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQzs7QUFVNUMsTUFBTSxPQUFPLGdCQUFnQjtJQVI3QjtRQVdjLG9CQUFlLEdBQW9CLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUMzRCxXQUFNLEdBQXNCLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUUzQyxlQUFVLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDO1FBQzFDLGVBQVUsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUM7UUFDMUMsaUJBQVksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUM7UUFDOUMsZUFBVSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsUUFB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QkFBQyxVQUFVLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBWaWV3Q2hpbGQsIFZpZXdFbmNhcHN1bGF0aW9uLCBpbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IG1hcCwgdGFrZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgTmdlRXhwbG9yZXJDb25maWcgfSBmcm9tICcuLi8uLi9zaGFyZWQvdHlwZXMnO1xuaW1wb3J0IHsgRXhwbG9yZXJTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvZXhwbG9yZXIuc2VydmljZSc7XG5pbXBvcnQgeyBWaWV3U3dpdGNoZXJDb21wb25lbnQgfSBmcm9tICcuLi92aWV3LXN3aXRjaGVyL3ZpZXctc3dpdGNoZXIuY29tcG9uZW50JztcbmltcG9ydCB7IENPTkZJRyB9IGZyb20gJy4uLy4uL3NoYXJlZC9wcm92aWRlcnMnO1xuaW1wb3J0IHsgQXN5bmNQaXBlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdueGUtbWVudS1iYXInLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9tZW51LWJhci5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vbWVudS1iYXIuY29tcG9uZW50LnNjc3MnXSxcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICAgIHN0YW5kYWxvbmU6IHRydWUsXG4gICAgaW1wb3J0czogW1ZpZXdTd2l0Y2hlckNvbXBvbmVudCwgQXN5bmNQaXBlXSxcbn0pXG5leHBvcnQgY2xhc3MgTWVudUJhckNvbXBvbmVudCB7XG4gICAgQFZpZXdDaGlsZCgndXBsb2FkZXInLCB7IHN0YXRpYzogdHJ1ZSB9KSB1cGxvYWRlciE6IEVsZW1lbnRSZWY7XG5cbiAgICBwcm90ZWN0ZWQgZXhwbG9yZXJTZXJ2aWNlOiBFeHBsb3JlclNlcnZpY2UgPSBpbmplY3QoRXhwbG9yZXJTZXJ2aWNlKTtcbiAgICBwcm90ZWN0ZWQgY29uZmlnOiBOZ2VFeHBsb3JlckNvbmZpZyA9IGluamVjdChDT05GSUcpO1xuXG4gICAgcHJvdGVjdGVkIGZlYXREZWxldGUgPSB0aGlzLmNvbmZpZy5mZWF0dXJlcz8uZGVsZXRlO1xuICAgIHByb3RlY3RlZCBmZWF0VXBsb2FkID0gdGhpcy5jb25maWcuZmVhdHVyZXM/LnVwbG9hZDtcbiAgICBwcm90ZWN0ZWQgZmVhdERvd25sb2FkID0gdGhpcy5jb25maWcuZmVhdHVyZXM/LmRvd25sb2FkO1xuICAgIHByb3RlY3RlZCBmZWF0UmVuYW1lID0gdGhpcy5jb25maWcuZmVhdHVyZXM/LnJlbmFtZTtcbiAgICBwcm90ZWN0ZWQgZmVhdENyZWF0ZURpciA9IHRoaXMuY29uZmlnLmZlYXR1cmVzPy5jcmVhdGVEaXI7XG5cbiAgICBwcm90ZWN0ZWQgY2FuRG93bmxvYWQkID0gdGhpcy5leHBsb3JlclNlcnZpY2Uuc2VsZWN0aW9uJC5waXBlKG1hcCgobikgPT4gbi5sZW5ndGggPT09IDEgJiYgblswXS5pc0xlYWYpKTtcbiAgICBwcm90ZWN0ZWQgY2FuRGVsZXRlJCA9IHRoaXMuZXhwbG9yZXJTZXJ2aWNlLnNlbGVjdGlvbiQucGlwZShtYXAoKG4pID0+IG4ubGVuZ3RoID4gMCkpO1xuICAgIHByb3RlY3RlZCBjYW5SZW5hbWUkID0gdGhpcy5leHBsb3JlclNlcnZpY2Uuc2VsZWN0aW9uJC5waXBlKG1hcCgobikgPT4gbi5sZW5ndGggPT09IDEpKTtcblxuICAgIGNyZWF0ZURpcigpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IHByb21wdCgnRW50ZXIgbmV3IG5hbWUnKTtcbiAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLmNyZWF0ZURpcihuYW1lKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlZnJlc2goKSB7XG4gICAgICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLnJlZnJlc2goKTtcbiAgICB9XG5cbiAgICByZW5hbWUoKSB7XG4gICAgICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLnNlbGVjdGlvbiRcbiAgICAgICAgICAgIC5waXBlKFxuICAgICAgICAgICAgICAgIHRha2UoMSksXG4gICAgICAgICAgICAgICAgbWFwKChuKSA9PiBuWzBdKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgobm9kZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9sZE5hbWUgPSBub2RlLm5hbWU7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3TmFtZSA9IHByb21wdCgnRW50ZXIgbmV3IG5hbWUnLCBvbGROYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmV4cGxvcmVyU2VydmljZS5yZW5hbWUobmV3TmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVtb3ZlKCkge1xuICAgICAgICBpZiAoY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGUgc2VsZWN0ZWQgZmlsZXM/JykpIHtcbiAgICAgICAgICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb3BlblVwbG9hZGVyKCkge1xuICAgICAgICB0aGlzLnVwbG9hZGVyLm5hdGl2ZUVsZW1lbnQuY2xpY2soKTtcbiAgICB9XG5cbiAgICBoYW5kbGVGaWxlcyhldmVudDogRXZlbnQpIHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSAoZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLmZpbGVzO1xuICAgICAgICBpZiAoIWZpbGVzIHx8IGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlLnVwbG9hZChmaWxlcyk7XG4gICAgICAgIHRoaXMudXBsb2FkZXIubmF0aXZlRWxlbWVudC52YWx1ZSA9ICcnO1xuICAgIH1cblxuICAgIGRvd25sb2FkKCkge1xuICAgICAgICB0aGlzLmV4cGxvcmVyU2VydmljZS5kb3dubG9hZCgpO1xuICAgIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJueGUtbWVudS1iYXJcIj5cbiAgICA8ZGl2IGNsYXNzPVwibnhlLW1lbnUtYmFyLWxlZnRcIj5cbiAgICAgICAgQGlmIChmZWF0Q3JlYXRlRGlyKSB7XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwibnhlLW1lbnUtYmFyLWJ1dHRvblwiIChjbGljayk9XCJjcmVhdGVEaXIoKVwiPjxpIGNsYXNzPVwibnhlLWZvbGRlclwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5OZXcgRm9sZGVyPC9idXR0b24+XG4gICAgICAgIH1cblxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwibnhlLW1lbnUtYmFyLWJ1dHRvblwiIChjbGljayk9XCJyZWZyZXNoKClcIj48aSBjbGFzcz1cIm54ZS1hcnJvd3MtY3dcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IFJlZnJlc2g8L2J1dHRvbj5cblxuICAgICAgICBAaWYgKGZlYXRVcGxvYWQpIHtcbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJueGUtbWVudS1iYXItYnV0dG9uXCIgKGNsaWNrKT1cIm9wZW5VcGxvYWRlcigpXCI+PGkgY2xhc3M9XCJueGUtdXBsb2FkXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPiBVcGxvYWQ8L2J1dHRvbj5cbiAgICAgICAgfVxuXG4gICAgICAgIEBpZiAoZmVhdERvd25sb2FkKSB7XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwibnhlLW1lbnUtYmFyLWJ1dHRvblwiIFtkaXNhYmxlZF09XCIhKGNhbkRvd25sb2FkJCB8IGFzeW5jKVwiIChjbGljayk9XCJkb3dubG9hZCgpXCI+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJueGUtZG93bmxvYWRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IERvd25sb2FkXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgfVxuXG4gICAgICAgIEBpZiAoZmVhdFJlbmFtZSkge1xuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cIm54ZS1tZW51LWJhci1idXR0b25cIiBbZGlzYWJsZWRdPVwiIShjYW5SZW5hbWUkIHwgYXN5bmMpXCIgKGNsaWNrKT1cInJlbmFtZSgpXCI+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJueGUtZWRpdFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4gUmVuYW1lXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgfVxuXG4gICAgICAgIEBpZiAoZmVhdERlbGV0ZSkge1xuICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cIm54ZS1tZW51LWJhci1idXR0b25cIiBbZGlzYWJsZWRdPVwiIShjYW5EZWxldGUkIHwgYXN5bmMpXCIgKGNsaWNrKT1cInJlbW92ZSgpXCI+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJueGUtdHJhc2gtZW1wdHlcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IERlbGV0ZVxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIH1cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwibnhlLW1lbnUtYmFyLXJpZ2h0XCI+XG4gICAgICAgIDxueGUtdmlldy1zd2l0Y2hlcj48L254ZS12aWV3LXN3aXRjaGVyPlxuICAgIDwvZGl2PlxuICAgIDxpbnB1dCBzdHlsZT1cImRpc3BsYXk6IG5vbmVcIiB0eXBlPVwiZmlsZVwiIG11bHRpcGxlIChjaGFuZ2UpPVwiaGFuZGxlRmlsZXMoJGV2ZW50KVwiICN1cGxvYWRlciAvPlxuPC9kaXY+XG4iXX0=